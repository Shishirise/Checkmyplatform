<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Choose Your Role</title>
<link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>

<div class="topic">Choose Your Role</div>

<div class="slide-wrapper" id="slideWrapper">
    <div class="slide-labels">
        <span class="player-label">◀ PLAYER</span>
        <span class="agent-label">AGENT ▶</span>
    </div>

    <div class="slide-handle" id="slideHandle">&#10094; &#10095;</div>
</div>

<script>
const handle = document.getElementById('slideHandle');
const wrapper = document.getElementById('slideWrapper');
let dragging = false, startX = 0, currentX = 0;

function getCenter() {
    return (wrapper.offsetWidth - handle.offsetWidth) / 2;
}

function startDrag(e) {
    dragging = true;
    startX = e.touches ? e.touches[0].clientX : e.clientX;
    handle.style.transition = 'none';
    handle.classList.add('dragging');
}

function dragMove(e) {
    if (!dragging) return;

    const x = e.touches ? e.touches[0].clientX : e.clientX;
    const delta = x - startX;
    const maxMove = getCenter();

    currentX = Math.max(-maxMove, Math.min(maxMove, delta));
    handle.style.transform = `translateX(${currentX}px)`;

    const percent = currentX / maxMove;

    if (percent > 0) {
        wrapper.style.background = `linear-gradient(
            270deg,
            rgba(255,82,82,${Math.abs(percent)}) 0%,
            rgba(255,82,82,0.15) 100%
        )`;
    } else if (percent < 0) {
        wrapper.style.background = `linear-gradient(
            90deg,
            rgba(0,204,255,${Math.abs(percent)}) 0%,
            rgba(0,204,255,0.15) 100%
        )`;
    }
}

function endDrag() {
    if (!dragging) return;
    dragging = false;
    handle.style.transition = 'transform 0.3s ease';
    handle.classList.remove('dragging');

    const threshold = getCenter() * 0.6;
    if (currentX < -threshold) window.location.href = "/player";
    else if (currentX > threshold) window.location.href = "/agent";

    handle.style.transform = 'translateX(0)';
}

handle.addEventListener('touchstart', startDrag);
handle.addEventListener('touchmove', dragMove);
handle.addEventListener('touchend', endDrag);
handle.addEventListener('mousedown', startDrag);
document.addEventListener('mousemove', dragMove);
document.addEventListener('mouseup', endDrag);
</script>

</body>
</html>
