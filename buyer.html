<!DOCTYPE html>
<html>
<head>
<title>Buyer Chat</title>
<script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>

<style>
body { margin:0; font-family:Arial; background:#ece5dd; }
.header { background:#075e54; color:white; padding:15px; text-align:center; }
#chat { height:75vh; overflow-y:auto; padding:10px; }
.msg { max-width:70%; padding:10px; margin:6px; border-radius:10px; }
.me { background:#dcf8c6; margin-left:auto; }
.other { background:white; }
.input { display:flex; padding:10px; background:white; }
input { flex:1; padding:10px; border-radius:20px; border:1px solid #ccc; }
button { background:#075e54; color:white; border:none; padding:10px 15px; border-radius:50%; }
</style>
</head>

<body>

<div class="header">Buyer Chat</div>
<div id="chat"></div>

<div class="input">
<input id="message" placeholder="Type a message">
<button onclick="send()">âž¤</button>
</div>

<script>
let username = "";
while (!username) username = prompt("Enter your name");

const socket = io("http://127.0.0.1:5000");
const room = "chat_" + username;
const chat = document.getElementById("chat");

socket.on("connect", () => {
    socket.emit("join", { room });
});

socket.on("receive_message", data => {
    const div = document.createElement("div");
    div.className = "msg " + (data.sender === username ? "me" : "other");
    div.innerHTML = `<b>${data.sender}</b><br>${data.message}`;
    chat.appendChild(div);
    chat.scrollTop = chat.scrollHeight;
});

function send() {
    const msg = document.getElementById("message");
    if (!msg.value) return;

    socket.emit("send_message", {
        room: room,
        sender: username,
        message: msg.value
    });

    msg.value = "";
}
</script>

</body>
</html>
